<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selbsteinsch√§tzung - BBW Digitale Kompetenzen</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            min-height: calc(100vh - 40px);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .back-button {
            display: inline-block;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
            transition: background 0.3s;
        }

        .back-button:hover {
            background: #5a67d8;
        }

        h1 {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #718096;
            font-size: 1.1em;
        }

        /* Code Entry Section */
        .code-entry {
            background: #f8f9fa;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }

        .code-entry h2 {
            color: #495057;
            margin-bottom: 20px;
        }

        .code-input-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 30px 0;
        }

        .code-input {
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            width: 250px;
            text-align: center;
            text-transform: uppercase;
        }

        .code-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .start-button {
            padding: 15px 40px;
            background: #FF6B6B;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .start-button:hover {
            background: #E53E3E;
            transform: translateY(-2px);
        }

        .start-button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }

        /* Test Section */
        .test-section {
            display: none;
        }

        .test-section.active {
            display: block;
        }

        /* Progress Bar */
        .progress-container {
            background: #e9ecef;
            border-radius: 10px;
            height: 30px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Question Card */
        .question-card {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: none;
        }

        .question-card.active {
            display: block;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .category-badge {
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            font-size: 0.9em;
            font-weight: bold;
        }

        .category-1 { background: #3887be; }
        .category-2 { background: #28a745; }
        .category-3 { background: #e74c3c; }
        .category-4 { background: #8e44ad; }
        .category-5 { background: #e67e22; }

        .question-text {
            font-size: 1.2em;
            color: #2d3748;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        /* Answer Options */
        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .answer-option {
            padding: 15px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .answer-option:hover {
            border-color: #667eea;
            background: #f7f7ff;
        }

        .answer-option input[type="radio"] {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .answer-option label {
            cursor: pointer;
            flex: 1;
        }

        .answer-option.selected {
            border-color: #667eea;
            background: #f0f0ff;
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .prev-button {
            background: #e9ecef;
            color: #495057;
        }

        .prev-button:hover {
            background: #dee2e6;
        }

        .next-button {
            background: #667eea;
            color: white;
        }

        .next-button:hover {
            background: #5a67d8;
        }

        .submit-button {
            background: #28a745;
            color: white;
        }

        .submit-button:hover {
            background: #218838;
        }

        /* Results Section */
        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            font-weight: bold;
            color: white;
        }

        .score-excellent { background: linear-gradient(135deg, #28a745, #20c997); }
        .score-good { background: linear-gradient(135deg, #ffc107, #fd7e14); }
        .score-needs-improvement { background: linear-gradient(135deg, #dc3545, #c82333); }

        .category-results {
            margin: 30px 0;
        }

        .category-result {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .category-result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .category-result-title {
            font-weight: bold;
            color: #2d3748;
        }

        .category-result-score {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
            background: white;
        }

        .result-bar-container {
            background: #e9ecef;
            border-radius: 5px;
            height: 20px;
            overflow: hidden;
        }

        .result-bar {
            height: 100%;
            border-radius: 5px;
            transition: width 1s ease;
        }

        /* Recommendations */
        .recommendations {
            background: #f0f8ff;
            border: 2px solid #667eea;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }

        .recommendations h3 {
            color: #495057;
            margin-bottom: 20px;
        }

        .recommendation-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .action-button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .print-button {
            background: #6c757d;
            color: white;
        }

        .print-button:hover {
            background: #5a6268;
        }

        .restart-button {
            background: #667eea;
            color: white;
        }

        .restart-button:hover {
            background: #5a67d8;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .code-input {
                width: 200px;
            }

            .question-text {
                font-size: 1.1em;
            }

            .nav-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .nav-button {
                width: 100%;
            }
        }

        @media print {
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }

            .back-button,
            .action-buttons {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-button">‚Üê Zur√ºck zur Startseite</a>
        
        <div class="header">
            <h1>Selbsteinsch√§tzung</h1>
            <p class="subtitle">√úberpr√ºfen Sie Ihre digitalen Kompetenzen</p>
        </div>

        <!-- Code Entry Section -->
        <div id="codeEntry" class="code-entry">
            <h2>Zugangs-Code eingeben</h2>
            <p>Bitte geben Sie den Code ein, den Sie von Ihrer Abteilungsleitung erhalten haben.</p>
            <div class="code-input-group">
                <input type="text" 
                       id="accessCode" 
                       class="code-input" 
                       placeholder="CODE-XXXX" 
                       maxlength="10">
                <button id="startTest" class="start-button" onclick="startTest()">
                    Test starten
                </button>
            </div>
            <p style="color: #6c757d; font-size: 0.9em; margin-top: 20px;">
                Der Code dient zur anonymen Zuordnung Ihrer Ergebnisse zu Ihrer Abteilung.
            </p>
        </div>

        <!-- Test Section -->
        <div id="testSection" class="test-section">
            <div class="progress-container">
                <div id="progressBar" class="progress-bar" style="width: 0%">
                    0%
                </div>
            </div>

            <!-- Questions will be dynamically inserted here -->
            <div id="questionContainer"></div>

            <div class="nav-buttons">
                <button id="prevButton" class="nav-button prev-button" onclick="previousQuestion()">
                    ‚Üê Zur√ºck
                </button>
                <button id="nextButton" class="nav-button next-button" onclick="nextQuestion()">
                    Weiter ‚Üí
                </button>
                <button id="submitButton" class="nav-button submit-button" onclick="submitTest()" style="display: none;">
                    Test abschlie√üen
                </button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="results-section">
            <div class="results-header">
                <h2>Ihre Ergebnisse</h2>
                <div id="scoreCircle" class="score-circle">
                    <!-- Score will be inserted here -->
                </div>
                <p id="scoreText" style="font-size: 1.2em; color: #495057;"></p>
            </div>

            <div id="categoryResults" class="category-results">
                <!-- Category results will be inserted here -->
            </div>

            <div id="recommendations" class="recommendations">
                <h3>Empfohlene Entwicklungsma√ünahmen</h3>
                <div id="recommendationsList">
                    <!-- Recommendations will be inserted here -->
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-button print-button" onclick="window.print()">
                    üìÑ Ergebnisse drucken
                </button>
                <button class="action-button restart-button" onclick="restartTest()">
                    üîÑ Neuer Test
                </button>
            </div>
        </div>
    </div>

    <script>
        // Test Questions Database
        const questions = [
            // Bereich 1: Grundkenntnisse IKT
            {
                id: 1,
                category: 1,
                categoryName: "Grundkenntnisse IKT",
                text: "Wie sicher f√ºhlen Sie sich beim Verbinden von technischen Ger√§ten (z.B. Beamer, Drucker) mit Ihrem Computer?",
                options: [
                    { value: 4, text: "Sehr sicher - Ich kann problemlos verschiedene Ger√§te verbinden und konfigurieren" },
                    { value: 3, text: "Sicher - Ich kann die meisten Ger√§te ohne Hilfe verbinden" },
                    { value: 2, text: "Teilweise sicher - Manchmal ben√∂tige ich Unterst√ºtzung" },
                    { value: 1, text: "Unsicher - Ich ben√∂tige oft Hilfe beim Verbinden von Ger√§ten" }
                ]
            },
            {
                id: 2,
                category: 1,
                categoryName: "Grundkenntnisse IKT",
                text: "Wie gut k√∂nnen Sie Office-Programme (Word, Excel, PowerPoint) f√ºr die Erstellung von Unterrichtsmaterialien nutzen?",
                options: [
                    { value: 4, text: "Expertenniveau - Ich nutze erweiterte Funktionen wie Makros, Vorlagen und Automatisierungen" },
                    { value: 3, text: "Fortgeschritten - Ich kann ansprechende Materialien mit verschiedenen Funktionen erstellen" },
                    { value: 2, text: "Grundkenntnisse - Ich kann einfache Dokumente und Pr√§sentationen erstellen" },
                    { value: 1, text: "Anf√§nger - Ich kenne nur die Basisfunktionen" }
                ]
            },
            {
                id: 3,
                category: 1,
                categoryName: "Grundkenntnisse IKT",
                text: "Wie routiniert nutzen Sie Cloud-Dienste (OneDrive, Teams) f√ºr Ihre Unterrichtsvorbereitung?",
                options: [
                    { value: 4, text: "T√§glich - Cloud-Dienste sind integraler Bestandteil meiner Arbeit" },
                    { value: 3, text: "Regelm√§√üig - Ich nutze Cloud-Dienste mehrmals pro Woche" },
                    { value: 2, text: "Gelegentlich - Ich nutze Cloud-Dienste bei Bedarf" },
                    { value: 1, text: "Selten oder nie - Ich arbeite haupts√§chlich lokal" }
                ]
            },

            // Bereich 2: Anwendung im Unterricht
            {
                id: 4,
                category: 2,
                categoryName: "Anwendung im Unterricht",
                text: "Wie h√§ufig setzen Sie digitale Werkzeuge oder KI-Tools f√ºr die Erstellung von Lernmaterialien ein?",
                options: [
                    { value: 4, text: "Sehr h√§ufig - Bei fast jeder Unterrichtsvorbereitung" },
                    { value: 3, text: "H√§ufig - Mehrmals pro Woche" },
                    { value: 2, text: "Manchmal - Ein paar Mal im Monat" },
                    { value: 1, text: "Selten - Nur bei speziellen Anl√§ssen" }
                ]
            },
            {
                id: 5,
                category: 2,
                categoryName: "Anwendung im Unterricht",
                text: "Wie interaktiv gestalten Sie Ihren Unterricht mit digitalen Tools (z.B. Kahoot, Padlet, Forms)?",
                options: [
                    { value: 4, text: "Sehr interaktiv - Ich nutze regelm√§√üig verschiedene interaktive Tools" },
                    { value: 3, text: "Interaktiv - Ich setze gelegentlich interaktive Elemente ein" },
                    { value: 2, text: "Wenig interaktiv - Ich nutze selten interaktive Tools" },
                    { value: 1, text: "Nicht interaktiv - Ich kenne diese Tools kaum" }
                ]
            },
            {
                id: 6,
                category: 2,
                categoryName: "Anwendung im Unterricht",
                text: "Wie setzen Sie E-Assessments f√ºr die Leistungserfassung ein?",
                options: [
                    { value: 4, text: "Systematisch - Ich nutze regelm√§√üig formative und summative E-Assessments" },
                    { value: 3, text: "H√§ufig - Ich setze E-Assessments f√ºr Tests und Pr√ºfungen ein" },
                    { value: 2, text: "Gelegentlich - Ich experimentiere mit digitalen Bewertungsformen" },
                    { value: 1, text: "Nie - Ich nutze nur traditionelle Bewertungsmethoden" }
                ]
            },

            // Bereich 3: Medien- und Informationskompetenz
            {
                id: 7,
                category: 3,
                categoryName: "Medien- und Informationskompetenz",
                text: "Wie gut kennen Sie die Funktionsweise von Social Media und deren m√∂gliche Einsatzorte im Unterricht?",
                options: [
                    { value: 4, text: "Sehr gut - Ich kenne verschiedene Plattformen und ihre didaktischen M√∂glichkeiten" },
                    { value: 3, text: "Gut - Ich verstehe die Grundprinzipien und nutze sie gelegentlich" },
                    { value: 2, text: "Grundkenntnisse - Ich kenne Social Media privat, aber nicht f√ºr den Unterricht" },
                    { value: 1, text: "Wenig - Ich habe kaum Erfahrung mit Social Media" }
                ]
            },
            {
                id: 8,
                category: 3,
                categoryName: "Medien- und Informationskompetenz",
                text: "K√∂nnen Sie multimediale Inhalte (Videos, Podcasts, interaktive Pr√§sentationen) f√ºr Ihren Unterricht erstellen?",
                options: [
                    { value: 4, text: "Ja, professionell - Ich erstelle regelm√§√üig hochwertige multimediale Inhalte" },
                    { value: 3, text: "Ja, gut - Ich kann verschiedene Medienformate erstellen" },
                    { value: 2, text: "Teilweise - Ich kann einfache Videos oder Audiodateien erstellen" },
                    { value: 1, text: "Nein - Ich nutze nur vorgefertigte Inhalte" }
                ]
            },
            {
                id: 9,
                category: 3,
                categoryName: "Medien- und Informationskompetenz",
                text: "Wie vermitteln Sie Ihren Lernenden kritische Medienkompetenz und Quellenpr√ºfung?",
                options: [
                    { value: 4, text: "Systematisch - Es ist fester Bestandteil meines Unterrichts" },
                    { value: 3, text: "Regelm√§√üig - Ich thematisiere es bei passenden Gelegenheiten" },
                    { value: 2, text: "Gelegentlich - Ich spreche es manchmal an" },
                    { value: 1, text: "Selten - Es ist kein Schwerpunkt in meinem Unterricht" }
                ]
            },

            // Bereich 4: Datenverwaltung und Datensicherheit
            {
                id: 10,
                category: 4,
                categoryName: "Datenverwaltung und Datensicherheit",
                text: "Wie gut kennen Sie die rechtlichen Grundlagen zum Datenschutz im schulischen Kontext?",
                options: [
                    { value: 4, text: "Sehr gut - Ich kenne DSGVO und schulische Richtlinien im Detail" },
                    { value: 3, text: "Gut - Ich kenne die wichtigsten Regelungen" },
                    { value: 2, text: "Grundkenntnisse - Ich kenne die Basics" },
                    { value: 1, text: "Wenig - Ich bin unsicher bei Datenschutzfragen" }
                ]
            },
            {
                id: 11,
                category: 4,
                categoryName: "Datenverwaltung und Datensicherheit",
                text: "Wie verwalten Sie Ihre Passw√∂rter und Zugangsdaten?",
                options: [
                    { value: 4, text: "Professionell - Ich nutze einen Passwort-Manager und 2-Faktor-Authentifizierung" },
                    { value: 3, text: "Sicher - Ich verwende starke, unterschiedliche Passw√∂rter" },
                    { value: 2, text: "Ausreichend - Ich habe einige sichere Passw√∂rter" },
                    { value: 1, text: "Unsicher - Ich verwende oft dieselben oder einfache Passw√∂rter" }
                ]
            },
            {
                id: 12,
                category: 4,
                categoryName: "Datenverwaltung und Datensicherheit",
                text: "Wie strukturiert verwalten Sie digitale Unterrichtsmaterialien und Sch√ºlerdaten?",
                options: [
                    { value: 4, text: "Sehr strukturiert - Mit klarem System, Backups und Versionierung" },
                    { value: 3, text: "Strukturiert - Mit Ordnerstruktur und regelm√§√üigen Backups" },
                    { value: 2, text: "Teilweise strukturiert - Grundlegende Ordnung vorhanden" },
                    { value: 1, text: "Unstrukturiert - Wenig System in der Datenverwaltung" }
                ]
            },

            // Bereich 5: Kommunikation und Kollaboration
            {
                id: 13,
                category: 5,
                categoryName: "Kommunikation und Kollaboration",
                text: "Wie aktiv nutzen Sie Teams oder √§hnliche Plattformen f√ºr die Kommunikation mit Kollegium und Lernenden?",
                options: [
                    { value: 4, text: "Sehr aktiv - T√§gliche Nutzung f√ºr verschiedene Zwecke" },
                    { value: 3, text: "Aktiv - Regelm√§√üige Nutzung mehrmals pro Woche" },
                    { value: 2, text: "Gelegentlich - Bei Bedarf oder f√ºr spezielle Projekte" },
                    { value: 1, text: "Selten - Nur wenn unbedingt n√∂tig" }
                ]
            },
            {
                id: 14,
                category: 5,
                categoryName: "Kommunikation und Kollaboration",
                text: "Wie gut k√∂nnen Sie kollaborative Dokumente (z.B. in Teams/OneDrive) f√ºr gemeinsame Projekte nutzen?",
                options: [
                    { value: 4, text: "Expertenniveau - Ich kann komplexe kollaborative Projekte leiten" },
                    { value: 3, text: "Gut - Ich arbeite routiniert mit geteilten Dokumenten" },
                    { value: 2, text: "Grundkenntnisse - Ich kann an geteilten Dokumenten mitarbeiten" },
                    { value: 1, text: "Wenig Erfahrung - Ich arbeite lieber mit lokalen Dateien" }
                ]
            },
            {
                id: 15,
                category: 5,
                categoryName: "Kommunikation und Kollaboration",
                text: "Wie professionell ist Ihre digitale Kommunikation (Netiquette, Antwortzeiten, Strukturierung)?",
                options: [
                    { value: 4, text: "Sehr professionell - Klare Struktur, zeitnahe Antworten, professioneller Ton" },
                    { value: 3, text: "Professionell - Meist zeitnah und angemessen" },
                    { value: 2, text: "Ausreichend - Grundlegende H√∂flichkeit, gelegentliche Verz√∂gerungen" },
                    { value: 1, text: "Verbesserungsw√ºrdig - Unregelm√§√üige Kommunikation" }
                ]
            }
        ];

        // State Management
        let currentQuestionIndex = 0;
        let answers = {};
        let testCode = "";
        let testStartTime = null;

        // Start Test Function
        function startTest() {
            const codeInput = document.getElementById('accessCode');
            const code = codeInput.value.trim().toUpperCase();
            
            if (code.length < 4) {
                alert('Bitte geben Sie einen g√ºltigen Code ein.');
                return;
            }
            
            testCode = code;
            testStartTime = new Date();
            
            // Hide code entry, show test
            document.getElementById('codeEntry').style.display = 'none';
            document.getElementById('testSection').classList.add('active');
            
            // Initialize first question
            showQuestion(0);
        }

        // Show Question Function
        function showQuestion(index) {
            const container = document.getElementById('questionContainer');
            const question = questions[index];
            
            // Update progress bar
            const progress = Math.round(((index + 1) / questions.length) * 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progress + '%';
            progressBar.textContent = progress + '%';
            
            // Create question HTML with info button
            const questionHTML = `
                <div class="question-card active">
                    <div class="question-header">
                        <span class="category-badge category-${question.category}">
                            ${question.categoryName}
                        </span>
                        <span style="color: #718096;">
                            Frage ${index + 1} von ${questions.length}
                        </span>
                    </div>
                    <div class="question-text">
                        <span style="flex: 1;">${question.text}</span>
                        <button class="info-button" onclick="toggleInfo(${question.id})" title="Mehr Informationen">
                            ?
                        </button>
                    </div>
                    <div id="info-${question.id}" class="info-box">
                        <h4>üìç Praktische Beispiele</h4>
                        <p>${question.info.examples}</p>
                        
                        <h4 style="margin-top: 15px;">üõ†Ô∏è Empfohlene Tools</h4>
                        <p>${question.info.tools}</p>
                        
                        <h4 style="margin-top: 15px;">üí° Tipp</h4>
                        <p>${question.info.tips}</p>
                        
                        <div class="concept-tags">
                            <span class="concept-tag ikt-tag">${question.info.ikt}</span>
                            <span class="concept-tag paed-tag">${question.info.paed}</span>
                        </div>
                    </div>
                    <div class="answer-options">
                        ${question.options.map((option, i) => `
                            <div class="answer-option ${answers[question.id] === option.value ? 'selected' : ''}" 
                                 onclick="selectAnswer(${question.id}, ${option.value}, this)">
                                <input type="radio" 
                                       name="question${question.id}" 
                                       value="${option.value}"
                                       ${answers[question.id] === option.value ? 'checked' : ''}>
                                <label>${option.text}</label>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            container.innerHTML = questionHTML;
            
            // Update navigation buttons
            document.getElementById('prevButton').style.display = index === 0 ? 'none' : 'block';
            document.getElementById('nextButton').style.display = index === questions.length - 1 ? 'none' : 'block';
            document.getElementById('submitButton').style.display = index === questions.length - 1 ? 'block' : 'none';
        }

        // Toggle Info Box Function
        function toggleInfo(questionId) {
            const infoBox = document.getElementById(`info-${questionId}`);
            if (infoBox) {
                infoBox.classList.toggle('active');
            }
        }

        // Select Answer Function
        function selectAnswer(questionId, value, element) {
            answers[questionId] = value;
            
            // Update UI
            document.querySelectorAll('.answer-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            element.querySelector('input').checked = true;
        }

        // Navigation Functions
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            }
        }

        function nextQuestion() {
            if (!answers[questions[currentQuestionIndex].id]) {
                alert('Bitte w√§hlen Sie eine Antwort aus.');
                return;
            }
            
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
            }
        }

        // Submit Test Function
        function submitTest() {
            if (!answers[questions[currentQuestionIndex].id]) {
                alert('Bitte w√§hlen Sie eine Antwort aus.');
                return;
            }
            
            // Calculate results
            const results = calculateResults();
            
            // Show results
            showResults(results);
            
            // Save to localStorage (simulate backend)
            saveResults(results);
        }

        // Calculate Results Function
        function calculateResults() {
            const categoryScores = {};
            const categoryMaxScores = {};
            const categoryQuestions = {};
            
            // Initialize categories
            for (let i = 1; i <= 5; i++) {
                categoryScores[i] = 0;
                categoryMaxScores[i] = 0;
                categoryQuestions[i] = 0;
            }
            
            // Calculate scores per category
            questions.forEach(question => {
                if (answers[question.id]) {
                    categoryScores[question.category] += answers[question.id];
                    categoryMaxScores[question.category] += 4; // Max score per question is 4
                    categoryQuestions[question.category]++;
                }
            });
            
            // Calculate percentages
            const categoryPercentages = {};
            for (let i = 1; i <= 5; i++) {
                if (categoryMaxScores[i] > 0) {
                    categoryPercentages[i] = Math.round((categoryScores[i] / categoryMaxScores[i]) * 100);
                } else {
                    categoryPercentages[i] = 0;
                }
            }
            
            // Calculate total score
            const totalScore = Object.values(categoryScores).reduce((a, b) => a + b, 0);
            const totalMaxScore = Object.values(categoryMaxScores).reduce((a, b) => a + b, 0);
            const totalPercentage = Math.round((totalScore / totalMaxScore) * 100);
            
            return {
                totalScore,
                totalMaxScore,
                totalPercentage,
                categoryScores,
                categoryMaxScores,
                categoryPercentages,
                testCode,
                timestamp: new Date().toISOString(),
                duration: Math.round((new Date() - testStartTime) / 1000) // in seconds
            };
        }

        // Show Results Function
        function showResults(results) {
            // Hide test section
            document.getElementById('testSection').classList.remove('active');
            
            // Show results section
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.classList.add('active');
            
            // Set score circle
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreText = document.getElementById('scoreText');
            
            scoreCircle.textContent = results.totalPercentage + '%';
            
            if (results.totalPercentage >= 80) {
                scoreCircle.className = 'score-circle score-excellent';
                scoreText.textContent = 'Ausgezeichnet! Sie verf√ºgen √ºber sehr gute digitale Kompetenzen.';
            } else if (results.totalPercentage >= 60) {
                scoreCircle.className = 'score-circle score-good';
                scoreText.textContent = 'Gut! Sie haben solide digitale Kompetenzen mit Entwicklungspotenzial.';
            } else {
                scoreCircle.className = 'score-circle score-needs-improvement';
                scoreText.textContent = 'Es besteht Entwicklungsbedarf in mehreren Bereichen.';
            }
            
            // Category Results
            const categoryNames = [
                "Grundkenntnisse IKT",
                "Anwendung im Unterricht",
                "Medien- und Informationskompetenz",
                "Datenverwaltung und Datensicherheit",
                "Kommunikation und Kollaboration"
            ];
            
            const categoryResultsHTML = categoryNames.map((name, i) => {
                const categoryNum = i + 1;
                const percentage = results.categoryPercentages[categoryNum];
                const barColor = percentage >= 80 ? '#28a745' : percentage >= 60 ? '#ffc107' : '#dc3545';
                
                return `
                    <div class="category-result">
                        <div class="category-result-header">
                            <span class="category-result-title">${name}</span>
                            <span class="category-result-score">${percentage}%</span>
                        </div>
                        <div class="result-bar-container">
                            <div class="result-bar" 
                                 style="width: ${percentage}%; background: ${barColor};">
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('categoryResults').innerHTML = categoryResultsHTML;
            
            // Recommendations
            const recommendations = generateRecommendations(results);
            const recommendationsHTML = recommendations.map(rec => `
                <div class="recommendation-item">
                    <strong>${rec.title}:</strong> ${rec.text}
                </div>
            `).join('');
            
            document.getElementById('recommendationsList').innerHTML = recommendationsHTML;
        }

        // Generate Recommendations Function
        function generateRecommendations(results) {
            const recommendations = [];
            const categoryNames = [
                "Grundkenntnisse IKT",
                "Anwendung im Unterricht",
                "Medien- und Informationskompetenz",
                "Datenverwaltung und Datensicherheit",
                "Kommunikation und Kollaboration"
            ];
            
            const categoryRecommendations = {
                1: [
                    "Besuchen Sie Basis-Schulungen zu Office 365 und Cloud-Diensten",
                    "Nutzen Sie die IT-Sprechstunde f√ºr individuelle Unterst√ºtzung",
                    "Erkunden Sie die Ed-Tech-Lizenzen Ihrer Schule systematisch"
                ],
                2: [
                    "Experimentieren Sie mit interaktiven Tools wie Kahoot oder Padlet",
                    "Besuchen Sie Workshops zu digitaler Unterrichtsgestaltung",
                    "Tauschen Sie sich mit digital-affinen Kollegen aus"
                ],
                3: [
                    "Lernen Sie Tools zur Erstellung multimedialer Inhalte kennen",
                    "Integrieren Sie Medienkritik als festen Unterrichtsbestandteil",
                    "Erkunden Sie die didaktischen M√∂glichkeiten von Social Media"
                ],
                4: [
                    "Nehmen Sie an einer Datenschutz-Schulung teil",
                    "Implementieren Sie ein Passwort-Management-System",
                    "Entwickeln Sie eine strukturierte Dateiablage"
                ],
                5: [
                    "Nutzen Sie Teams aktiver f√ºr die Zusammenarbeit",
                    "Lernen Sie kollaborative Arbeitsweisen kennen",
                    "Verbessern Sie Ihre digitale Kommunikationsstruktur"
                ]
            };
            
            // Find weakest areas (below 60%)
            for (let i = 1; i <= 5; i++) {
                if (results.categoryPercentages[i] < 60) {
                    const recList = categoryRecommendations[i];
                    recommendations.push({
                        title: categoryNames[i - 1],
                        text: recList[Math.floor(Math.random() * recList.length)]
                    });
                }
            }
            
            // If no weak areas, suggest advanced topics
            if (recommendations.length === 0) {
                recommendations.push({
                    title: "Fortgeschrittene Kompetenzen",
                    text: "Erkunden Sie KI-Tools f√ºr den Unterricht und werden Sie Digital-Mentor f√ºr Ihr Kollegium"
                });
            }
            
            return recommendations.slice(0, 3); // Return max 3 recommendations
        }

        // Save Results Function
        function saveResults(results) {
            // Get existing results from localStorage
            let allResults = JSON.parse(localStorage.getItem('bbw_test_results') || '[]');
            
            // Add new result
            allResults.push(results);
            
            // Save back to localStorage
            localStorage.setItem('bbw_test_results', JSON.stringify(allResults));
            
            // Also save with code for department analysis
            const codeResults = JSON.parse(localStorage.getItem(`bbw_results_${results.testCode}`) || '[]');
            codeResults.push(results);
            localStorage.setItem(`bbw_results_${results.testCode}`, JSON.stringify(codeResults));
        }

        // Restart Test Function
        function restartTest() {
            // Reset all variables
            currentQuestionIndex = 0;
            answers = {};
            testCode = "";
            testStartTime = null;
            
            // Reset UI
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('testSection').classList.remove('active');
            document.getElementById('codeEntry').style.display = 'block';
            document.getElementById('accessCode').value = '';
        }

        // Enable Enter key for code input
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('accessCode').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startTest();
                }
            });
        });
    </script>
</body>
</html>
